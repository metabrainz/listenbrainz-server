{% extends 'base.html' %}

{% block title %}User "{{ user.musicbrainz_id }}" - ListenBrainz{% endblock %}

{% block content %}
  <div id="user-profile">
    <h2 class="page-title">{{ user.musicbrainz_id }}</h2>

    <h3> Delete your account </h3>

    <p>
      <a href="{{ url_for("profile.delete") }}" style="color: white;"><span class="btn btn-info btn-lg" style="width: 300px">Delete your account</span></a>
    </p>

    <h3> Delete your listens </h3>
    <p>
      This will delete all your listens imported into Listenbrainz.
    </p>

    <p>
      <a href="{{ url_for("profile.delete_listens") }}" style="color: white;"><span class="btn btn-info btn-lg" style="width: 300px">Delete your listens</span></a>
    </p>

    <h3> Reset Last.FM Import timestamp </h3>
    <p>
      If you think that a partial import has somehow missed some listens, you may reset your previous
      import timestamp. This will cause your next import to be a complete import which should add any
      missing listens while still avoiding adding duplicates to your history.
    </p>

    <p>If you want to reset your previous import timestamp, click below</p>
    <p>
      <span class="btn btn-info btn-lg" style="width: 300px"><a href="{{ url_for("profile.reset_latest_import_timestamp") }}" style="color: white;">Reset Import Timestamp</a></span>
    </p>

    <h3>User token</h3>
    <p>
      If you would like to use an external program to submit data to ListenBrainz you will need the user token:
    </p>

    <div class="form-inline form-group">
      <p><b>Copy User Token</b>
      <input class="form-control" id="auth-token" type="hidden" size="36" value="{{ user.auth_token }}" readonly>
      <button class="btn btn-info btn-sm glyphicon glyphicon-copy" id="copy-token" title="Copy token to clipboard"></button>
      </p>
    </div>

    <div class="divcontainer">
      <p><b>User Token</b>
        <span class="btn btn-info glyphicon glyphicon-dropdown glyphicon-chevron-down" data-toggle="collapse" data-target="#collapsecontent" style="width: 50px"></span>
        <div class="collapse" id="collapsecontent">{{ user.auth_token }}</div>
      </p>
    </div>

    <p>If you want to reset your token, click below</p>
    <p>
      <span class="btn btn-info btn-lg" style="width: 200px"><a href="{{ url_for("profile.reset_token") }}" style="color: white;">Reset token</a></span>
    </p>

    <h3> Request Statistics Calculation </h3>

    <p>
      There have been some problems with our statistics infrastructure which used Google BigQuery. We're currently in
      the process of fixing it. In the meantime, new statistics will not be calculated. Please bear with us while
      we work on getting statistics back, hopefully very soon!
    </p>

  </div>

{% endblock %}

{% block scripts %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/info.js') }}"></script>
{% endblock %}
