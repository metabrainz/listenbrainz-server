<svg
  width="924"
  height="924"
  viewBox="0 0 924 924"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <title>{{ year }} in Music overview for {{ user_name }}</title>
  <desc>&#xA;
  {{ "{:,}".format(artists_count) }} artists,
  {{ "{:,}".format(albums_count) }} albums,
  {{ "{:,}".format(songs_count) }} songs listened to.&#xA;
  {%- if album_1 -%}
  #1: {{ album_1['title'] }} by {{ album_1['artist'] }}
  ({{ "{:,}".format(album_1['listen_count']) }} listens).&#xA;
  {%- endif -%}
  {%- if album_2 -%}
  #2: {{ album_2['title'] }} by {{ album_2['artist'] }}
  ({{ "{:,}".format(album_2['listen_count']) }} listens).&#xA;
  {%- endif -%}
  Top genres:
  {%- for genre in genres -%}
  {{ genre['genre'] }} {{ genre['genre_count_percent'] }}%
  {%- if not loop.last %}, {% endif -%}
  {%- endfor -%}.
  </desc>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;900');
    text {
    fill: {{ accent_color }};
    font-family: Inter, sans-serif;
    font-weight: 900;
    }
    .branding {
    font-size: 20px;
    letter-spacing: 0em;
    }
    .heading, .entity-count {
    font-size: 70px;
    }
    .listen-count, .album-name, .artist-name {
    font-size: 20px;
    }
    .album-name, .artist-name {
    font-family: Inter, sans-serif;
    font-weight: 900;
    color: {{ accent_color }};
    }
    .album-name {
    margin: 8px;
    }
    .artist-name {
    font-weight: 300;
    margin: 8px;
    margin-top: 0;
    }
    .entity {
    font-weight: 300;
    font-size: 70px;
    }
    .genre-count {
    font-size: 50px;
    }
    .value {
    font-weight: 300;
    }
    .accent-color-stroke {
    stroke: {{ accent_color }};
    }
    stop:first-child {
    stop-color: {{background_color_1}};
    }
    .bg-color-1 {
    fill: {{background_color_1}};
    }
    stop:nth-child(2) {
    stop-color: {{background_color_2}};
    }
    .bg-color-2 {
    fill: {{background_color_2}};
    }
  </style>
  <defs>
    <linearGradient id="gradient" x1="-20%" y1="-20%" x2="100%" y2="100%"
      gradientUnits="userSpaceOnUse">
      <stop offset="0" stop-color="#083b2b" />
      <stop offset="1" stop-color="#111820" />
    </linearGradient>
    <clipPath id="clip">
      <use xlink:href="#background" />
    </clipPath>
    <mask id="cover-art-mask">
      <rect x="346" y="373" width="396" height="396" fill="white" />
    </mask>
    <filter id="shadow">
      <feDropShadow dx="0" dy="0" stdDeviation="5" flood-opacity="0.4" />
    </filter>
  </defs>
  <g clip-path="url(#clip)">
    <rect id="background" height="924" fill="url(#gradient)" rx="4" ry="4" width="924" y="0"
      x="0" />
    <rect id="content-bg" width="750" height="750" x="85" y="80" fill="#00000040"
        class="accent-color-stroke" rx="8" ry="8" />
    {% if branding != False %}
    <g id="branding">
        {% if anonymous != True %}
        <text class="branding" x="30" y="43" id="text1248">{{user_name|upper|e}}</text>
        {% endif %}
        <text class="branding" x="30" y="897" id="text1250">MY STATS FOR {{year}}</text>
        <text class="branding" x="894" y="897" id="text1246" text-anchor="end">LISTENBRAINZ</text>
        <text class="branding" x="894" y="43" id="text1252" text-anchor="end">#YEARINMUSIC</text>
      </g>
      {% endif %}
      <text class="heading" font-style="italic">
        <tspan x="26" y="110">{{year}} IN</tspan>
        <tspan x="26" dy="80">MUSIC</tspan>
      </text>
      <line x1="26" x2="250" y1="224" y2="224" class="accent-color-stroke" stroke-width="8" />
      <g
      id="cover-art" transform="translate(0,-30)">
      <!-- Display small album cover, or colorful square with album name -->
       {%- if album_2 -%}
       <g id="album-2">
       {% if album_2['cover_art'] %}
        <image x="171" y="291" width="207"
          height="207" xlink:href="{{ album_2['cover_art'] }}" preserveAspectRatio="xMidYMid slice" />
        {% else %}
        <rect x="171" y="291" width="207" height="207" fill="#FFC93D" />
        <foreignObject
          x="171" y="498" width="207" height="207"
          style="transform: rotate(-90deg); transform-origin: 171px 498px;">
          <div xmlns="http://www.w3.org/1999/xhtml">
            <p class="album-name">{{ album_2['title']|upper|e }}</p>
            <p class="artist-name">{{ album_2['artist']|upper|e }}</p>
          </div>
        </foreignObject>
    {% endif %}
      <text class="listen-count"
        style="transform: rotate(-90deg); transform-origin: 158px 498px;" x="158" y="498">
        <tspan>#2:</tspan>
        <tspan class="value">{{ "{:,}".format(album_2['listen_count']) }} Listens</tspan>
      </text>
      </g> <!-- Closing id="album-2" group -->
    {% endif %}
      <!-- Display big album cover, or colorful square with album name -->
      {%- if album_1 -%}
      <g id="album-2">
      {% if album_1['cover_art'] %}
        <image x="346" y="373"
          width="396" height="396" xlink:href="{{ album_1['cover_art'] }}"
          preserveAspectRatio="xMidYMid slice" />
      {% else %}
        <rect x="346" y="373"
          width="396" height="396" fill="#EB743B" />
        <foreignObject x="742"
          y="373" width="396" height="396"
          style="transform: rotate(90deg); transform-origin: 742px 373px;">
          <div xmlns="http://www.w3.org/1999/xhtml">
            <p class="album-name">{{ album_1['title']|upper|e }}</p>
            <p class="artist-name">{{ album_1['artist']|upper|e }}</p>
          </div>
        </foreignObject>
    {% endif %} <text class="listen-count"
        style="transform: rotate(90deg); transform-origin: 755px 373px;" x="755" y="373">
        <tspan>#1:</tspan>
        <tspan class="value">{{ "{:,}".format(album_1['listen_count']) }} Listens</tspan>
      </text>
    </g> <!-- Closing id="album-1" group -->
    {%- endif -%}
  </g> <!-- Closing id="cover-art" group -->
  
  <g id="stats">
    <text text-anchor="end" x="874" y="184">
      <tspan class="entity-count">{{ "{:,}".format(artists_count) }}</tspan>
      <tspan class="entity" dx="16">ARTISTS</tspan>
    </text>
          <text text-anchor="end" x="874"
      y="254">
      <tspan class="entity-count">{{ "{:,}".format(albums_count) }}</tspan>
      <tspan class="entity" dx="16">ALBUMS</tspan>
    </text>
          <text text-anchor="end" x="874"
      y="324">
      <tspan class="entity-count">{{ "{:,}".format(songs_count) }}</tspan>
      <tspan class="entity" dx="16">SONGS</tspan>
    </text>
    <g id="top-genres" filter="url(#shadow)">
      {%- set y_start = 800 -%} {%- set
      y_step = 50 -%} {%- for genre in genres -%} <text
        class="genre-count"
        y="{{ y_start - y_step * loop.index0 }}"
      >
        <tspan class="value" x="170" text-anchor="end">{{ genre['genre_count_percent'] }}%</tspan>
        <tspan x="170">{{ genre['genre']|upper }}</tspan>
      </text> {%- endfor -%} </g>
    </g> <!-- Closing id="top-genres" group -->
  </g> <!-- Closing id="stats" group -->
</svg>